Acabamos de corrigir problemas de renderização dinâmica no e-commerce Essencial, focado em cosméticos e beleza. O principal problema era que o Next.js estava tentando renderizar estaticamente páginas que necessitavam de dados dinâmicos do Supabase. Corrigimos isso adicionando export const dynamic = "force-dynamic" e export const revalidate = 0 nos arquivos app/page.tsx e app/categoria/[slug]/page.tsx. Também ajustamos as funções de busca no Supabase (getFeaturedProducts, getCategories, getCategoryBySlug) para incluir logging adequado e melhor tratamento de erros.
Os arquivos principais modificados foram lib/supabase.ts (ajuste nas funções de busca e logging), app/page.tsx (configuração de renderização dinâmica e logs), app/categoria/[slug]/page.tsx (renderização dinâmica) e app/api/supabase/route.ts (ajustes na API). A estrutura do banco de dados no Supabase inclui duas tabelas principais: categories (com campos id, name, slug, description, image_url) e products (com campos id, name, slug, description, price, sale_price, category_id, stock_quantity, images, featured). O seed inicial do banco inclui 6 categorias e produtos de exemplo.
Lições importantes: 1) Sempre verificar o modo de renderização ao trabalhar com dados dinâmicos no Next.js 14; 2) Implementar logging detalhado ajuda na depuração de problemas com dados; 3) O Supabase requer configuração adequada de cookies para funcionar corretamente com SSR. Problemas atuais incluem a necessidade de implementar: autenticação com Firebase, upload de imagens com Cloudinary, carrinho de compras, e sistema de pagamentos. A estrutura atual está funcional mas precisa de otimizações de performance e implementação de cache onde apropriado. O projeto usa TailwindCSS para estilização, com uma paleta de cores definida focando em tons de laranja (orange-500) como cor principal e variações de cinza para hierarquia visual.
